!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],e):"object"==typeof exports?exports.de=e(require("jQuery")):t.de=e(t.jQuery)}(this,function(t){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.MappedJS=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),h=n(a),u=i(2),l=i(11),c=(i(10),i(12));e.MappedJS=function(){function t(e){var i=e.container,n=void 0===i?".mjs":i,o=e.mapData,r=void 0===o?{}:o,a=e.mapSettings,h=void 0===a?{}:a,u=e.events,l=void 0===u?{loaded:"mjs-loaded"}:u;return s(this,t),this.initializeSettings(n,l,h),this.initializeData(r,function(){this.initializeMap(),this.bindEvents(),this.loadingFinished()}.bind(this)),this}return r(t,[{key:"initializeSettings",value:function(t,e,i){if(this.$container="string"==typeof t?(0,h["default"])(t):"object"===("undefined"==typeof t?"undefined":o(t))&&t instanceof jQuery?t:(0,h["default"])(t),!(this.$container instanceof jQuery))throw new Error("Container "+t+" not found");return this.$container.addClass("mappedJS"),this.mapSettings={level:i.level||0,center:i.center||{lat:0,lng:0},bounds:i.bounds||{top:90,left:-180,width:360,height:180}},this.events=e,this}},{key:"initializeData",value:function(t,e){var i=this;return"string"==typeof t?l.Helper.requestJSON(t,function(t){i.mapData=t,e()}):(this.mapData="object"===("undefined"==typeof t?"undefined":o(t))?t:null,e()),this}},{key:"initializeMap",value:function(){return this.tileMap=new u.TileMap({container:this.$container,tilesData:this.mapData,settings:this.mapSettings}),this}},{key:"bindEvents",value:function(){return this.interact=new c.Interact({container:this.$container,callbacks:{tap:function(t){console.log("tap",t)}.bind(this),pan:function(t){var e=t.positions.last.substract(t.positions.current),i=e.multiply(this.tileMap.view.viewport.width,this.tileMap.view.viewport.height);this.tileMap.view.moveView(i),this.tileMap.redraw()}.bind(this),zoom:function(t){console.log("zoom",t)}.bind(this)}}),(0,h["default"])(window).on("resize orientationchange",this.resizeHandler.bind(this)),this}},{key:"resizeHandler",value:function(){return this.tileMap.resize(),this}},{key:"loadingFinished",value:function(){return this.$container.trigger(this.events.loaded),this}}]),t}()},function(e,i){e.exports=t},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.TileMap=void 0;var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(1),a=n(r),h=i(3),u=i(5),l=i(6),c=i(7),f=e.TileMap=function(){function t(e){var i=e.container,n=e.tilesData,o=void 0===n?{}:n,r=e.settings,a=void 0===r?{}:r;if(s(this,t),!i)throw Error("You must define a container to initialize a TileMap");return this.$container=i,this.imgData=o[t.IMG_DATA_NAME],this.settings=a,this.initialize(a.bounds,a.center,this.getCurrentLevelData().dimensions),this}return o(t,[{key:"left",get:function(){return this.$container.offset().left}},{key:"top",get:function(){return this.$container.offset().top}},{key:"width",get:function(){return this.$container.innerWidth()}},{key:"height",get:function(){return this.$container.innerHeight()}}]),o(t,[{key:"initialize",value:function(t,e,i){return this.view=new c.View({viewport:new l.Rectangle(this.left,this.top,this.width,this.height),mapView:new l.Rectangle(0,0,i.width,i.height),bounds:new u.Bounds(new h.LatLng(t.northWest[0],t.northWest[1]),new h.LatLng(t.southEast[0],t.southEast[1])),center:new h.LatLng(e.lat,e.lng),data:this.getCurrentLevelData(),drawCb:function(t,e,i,n,s){this.canvasContext.drawImage(t,e,i,n,s)}.bind(this)}),this.initializeCanvas(),this}},{key:"initializeCanvas",value:function(){return this.$canvas=(0,a["default"])("<canvas class='mjs-canvas' />"),this.canvas=this.$canvas[0],this.$container.append(this.$canvas),this.canvasContext=this.canvas.getContext("2d"),this.resize(),this}},{key:"getCurrentLevelData",value:function(){return this.imgData["level-"+this.settings.level]}},{key:"clearCanvas",value:function(){return this.canvasContext.clearRect(0,0,this.canvas.width,this.canvas.height),this}},{key:"redraw",value:function(){return this.clearCanvas(),this.view.drawVisibleTiles(),this}},{key:"resize",value:function(){return this.canvasContext.canvas.width=this.width,this.canvasContext.canvas.height=this.height,this.resizeView(),this}},{key:"resizeView",value:function(){var t=this.view.viewport.clone;this.view.viewport.size(this.left,this.top,this.width,this.height);var e=this.view.viewport.center.substract(t.center);return this.view.mapView.translate(e.x,e.y),this.view.drawVisibleTiles(),this}}]),t}();f.IMG_DATA_NAME="img_data"},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.LatLng=void 0;var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(4),r=e.LatLng=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],i=arguments.length<=1||void 0===arguments[1]?0:arguments[1];arguments.length<=2||void 0===arguments[2]?!1:arguments[2];return n(this,t),this.lat=e%90,this.lat=this.lat===-0?0:this.lat,this.lng=i%180,this.lng=this.lng===-0?0:this.lng,this}return s(t,[{key:"length",get:function(){return Math.sqrt(Math.pow(this.lat,2)+Math.pow(this.lng,2))}},{key:"clone",get:function(){return t.createFromLatLng(this)}}]),s(t,[{key:"substract",value:function(t){return this.lat-=t.lat,this.lng-=t.lng,this}},{key:"add",value:function(t){return this.lat+=t.lat,this.lng+=t.lng,this}},{key:"toPoint",value:function(t,e){var i=t.nw.clone.substract(this),n=e.width/t.width,s=e.height/t.height;return new o.Point(Math.abs(i.lng*n),Math.abs(i.lat*s))}},{key:"equals",value:function(t){return this.lat===t.lat&&this.lng===t.lng}}]),t}();r.createFromLatLng=function(t){return new r(t.lat,t.lng)}},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=e.Point=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return i(this,t),this.x=e,this.y=n,this}return n(t,[{key:"length",get:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}},{key:"clone",get:function(){return t.createFromPoint(this)}}]),n(t,[{key:"substract",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"multiply",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?t:arguments[1];return this.x*=t,this.y*=e,this}},{key:"divide",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?t:arguments[1];return this.x/=t,this.y/=e,this}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"distance",value:function(t){return this.clone.substract(t).length}},{key:"translate",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"position",value:function(t,e){return this.x=t,this.y=e,this}},{key:"toArray",value:function(){return[this.x,this.y]}}]),t}();s.createFromPoint=function(t){return new s(t.x,t.y)}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Bounds=void 0;var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(3);e.Bounds=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?new o.LatLng:arguments[0],i=arguments.length<=1||void 0===arguments[1]?new o.LatLng:arguments[1];if(n(this,t),e.lat<i.lat||e.lng>i.lng)throw new Error(e+" needs to be top-right corner and "+i+" bottom-left");return this.nw=e,this.so=i,this}return s(t,[{key:"width",get:function(){return Math.abs(this.so.lng-this.nw.lng)}},{key:"height",get:function(){return Math.abs(this.so.lat-this.nw.lat)}}]),t}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Rectangle=void 0;var r=function l(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var s=Object.getPrototypeOf(t);return null===s?void 0:l(s,e,i)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(i)},a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=i(4),u=e.Rectangle=function(t){function e(){var t,i=arguments.length<=0||void 0===arguments[0]?0:arguments[0],o=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?0:arguments[2],a=arguments.length<=3||void 0===arguments[3]?0:arguments[3];n(this,e);var h=s(this,Object.getPrototypeOf(e).call(this,i,o));return h.width=r,h.height=a,t=h,s(h,t)}return o(e,t),a(e,[{key:"center",get:function(){return new h.Point(this.x+this.width/2,this.y+this.height/2)}},{key:"topLeft",get:function(){return new h.Point(this.x,this.y)}},{key:"topRight",get:function(){return new h.Point(this.x+this.width,this.y)}},{key:"bottomLeft",get:function(){return new h.Point(this.x,this.y+this.height)}},{key:"bottomRight",get:function(){return new h.Point(this.x+this.width,this.y+this.height)}},{key:"right",get:function(){return this.x+this.width}},{key:"left",get:function(){return this.x}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}},{key:"clone",get:function(){return e.createFromRectangle(this)}}]),a(e,[{key:"intersects",value:function(t){return!(t.left>this.right||t.right<this.left||t.top>this.bottom||t.bottom<this.top)}},{key:"contains",value:function(t){return t instanceof e?this.containsRect(t):t instanceof h.Point?this.containsPoint(t):!1}},{key:"setCenter",value:function(t){var e=t.substract(this.center);return this.translate(e.x,e.y),this}},{key:"containsPoint",value:function(t){return t instanceof h.Point?t.x>=this.left&&t.y>=this.top&&t.x<=this.right&&t.y<=this.bottom:!1}},{key:"containsRect",value:function(t){return t instanceof e?t.left>=this.left&&t.top>=this.top&&t.right<=this.right&&t.bottom<=this.bottom:!1}},{key:"getDistortedRect",value:function(t){return new e(this.x,this.y,this.width,this.height).scaleX(t)}},{key:"scaleX",value:function(t){return this.x*=t,this.width*=t,this}},{key:"scaleY",value:function(t){return this.y*=t,this.height*=t,this}},{key:"scale",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?t:arguments[1];return this.x*=t,this.y*=e,this.width*=t,this.height*=e,this}},{key:"translate",value:function(t,i){return r(Object.getPrototypeOf(e.prototype),"translate",this).call(this,t,i),this}},{key:"transform",value:function(t,e,i,n){return this.translate(t,e),this.width+=i,this.height+=n,this}},{key:"position",value:function(t,i){return r(Object.getPrototypeOf(e.prototype),"position",this).call(this,t,i),this}},{key:"size",value:function(t,e,i,n){return this.position(t,e),this.width=i,this.height=n,this}},{key:"equals",value:function(t){return t instanceof e?this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height:!1}}]),e}(h.Point);u.createFromRectangle=function(t){return new u(t.x,t.y,t.width,t.height)}},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),o=i(3),r=(i(4),i(5)),a=i(6),h=i(8),u=i(10),l=i(11),c=new u.Publisher;e.View=function(){function t(e){var i=e.viewport,s=void 0===i?new a.Rectangle:i,h=e.mapView,u=void 0===h?new a.Rectangle:h,l=e.bounds,c=void 0===l?new r.Bounds:l,f=e.center,d=void 0===f?new o.LatLng:f,v=e.data,p=void 0===v?{}:v,g=e.drawCb;n(this,t),this.mapView=u,this.viewport=s,this.bounds=c,this.center=d;var y=this.viewport.center.substract(d.toPoint(this.bounds,this.mapView));return this.mapView.position(y.x,y.y),this.tiles=[],this.data=p,this.draw=g,this.bindEvents().initializeTiles(),this}return s(t,[{key:"equalizationFactor",get:function(){return Math.cos(l.Helper.toRadians(this.center.lat))}},{key:"viewportOffset",get:function(){return(this.viewport.width-this.viewport.width*this.equalizationFactor)/2}},{key:"visibleTiles",get:function(){return this.tiles.filter(function(t,e,i){var n=t.getDistortedRect(this.equalizationFactor).translate(this.mapView.x*this.equalizationFactor+this.viewportOffset,this.mapView.y);return this.viewport.intersects(n)},this)}}]),s(t,[{key:"onTilesLoaded",value:function(t){return this.drawTile(t),t.state.next(),this}},{key:"moveView",value:function(t){var e=this.mapView.clone,i=this.mapView.center.substract(t);this.mapView.setCenter(i);var n=this.mapView.getDistortedRect(this.equalizationFactor).translate(this.viewportOffset,0);return n.containsRect(this.viewport)||(n.x>0&&(this.mapView.x=e.x),n.y>0&&(this.mapView.y=e.y),n.width+n.x<this.viewport.width&&(this.mapView.x=e.x),n.height+n.y<this.viewport.height&&(this.mapView.y=e.y)),this}},{key:"drawVisibleTiles",value:function(){for(var t in this.visibleTiles)this.drawTile(this.visibleTiles[t]);return this}},{key:"drawTile",value:function(t){if(t.state.current.value>=2)if(this.draw&&"function"==typeof this.draw){var e=(t.x+this.mapView.x)*this.equalizationFactor+this.viewportOffset,i=t.y+this.mapView.y,n=t.width*this.equalizationFactor,s=t.height;this.draw(t.img,e,i,n,s)}else console.error("Draw method is not defined or not a function");else 0===t.state.current.value&&t.initialize();return this}},{key:"bindEvents",value:function(){return c.subscribe("tile-loaded",this.onTilesLoaded.bind(this)),this}},{key:"initializeTiles",value:function(){var t=this.data.tiles;for(var e in t){var i=t[e],n=new h.Tile(i);this.tiles.push(n)}return this}}]),t}()},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Tile=void 0;var a=function y(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var s=Object.getPrototypeOf(t);return null===s?void 0:y(s,e,i)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(i)},h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=i(1),l=(n(u),i(9)),c=i(6),f=i(10),d=i(11),v=new f.Publisher,p=[{value:0,description:"Starting"},{value:1,description:"Initialized"},{value:2,description:"Loaded"},{value:3,description:"Drawn"}],g="tile-loaded";e.Tile=function(t){function e(){var t,i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=i.path,r=i.x,a=void 0===r?0:r,h=i.y,u=void 0===h?0:h,c=i.w,f=void 0===c?0:c,d=i.h,v=void 0===d?0:d;s(this,e);var g=o(this,Object.getPrototypeOf(e).call(this,a,u,f,v));if(g.state=new l.StateHandler(p),!n||"string"!=typeof n||0===n.length)throw new TypeError("Path "+n+" needs to be of type string and should not be empty");return g.path=n,t=g,o(g,t)}return r(e,t),h(e,[{key:"Publisher",get:function(){return v}}]),h(e,[{key:"initialize",value:function(){return this.state.next(),d.Helper.loadImage(this.path,function(t){this.img=t,this.state.next(),v.publish(g,this)}.bind(this)),this}},{key:"equals",value:function(t){return t instanceof e?a(Object.getPrototypeOf(e.prototype),"equals",this).call(this,t)&&this.path===t.path:!1}}]),e}(c.Rectangle)},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.StateHandler=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?[{value:0,description:"Default"}]:arguments[0];return i(this,t),this.states=e,this.i=0,this}return n(t,[{key:"current",get:function(){return this.states[this.i]}},{key:"length",get:function(){return this.states.length}}]),n(t,[{key:"next",value:function(){return this.hasNext()&&this.i++,this}},{key:"previous",value:function(){return this.hasPrevious()&&this.i--,this}},{key:"changeTo",value:function(t){return t>=0&&t<this.length&&(this.i=t),this}},{key:"hasNext",value:function(){return this.i<this.length-1}},{key:"hasPrevious",value:function(){return this.i>0}}]),t}()},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=null,o=e.Publisher=function(){function t(){return i(this,t),s||(this.subscribers={},s=this),s}return n(t,[{key:"subscribe",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"any":arguments[0],e=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];return this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push(e),this}},{key:"unsubscribe",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"any":arguments[0],i=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];return this.handle(t.UNSUBSCRIBE,e,i),this}},{key:"publish",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"any":arguments[0],i=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return this.handle(t.PUBLISH,e,i),this}},{key:"handle",value:function(e,i,n){for(var s=this.subscribers[i]?this.subscribers[i]:[],o=0;o<s.length;o++)e===t.PUBLISH?s[o](n):s[o]===n&&s.splice(o,1);return this}},{key:"destroy",value:function(){s=null}}]),t}();o.PUBLISH="publish",o.UNSUBSCRIBE="unsubscribe"},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Helper=void 0;var s=i(1),o=n(s);e.Helper={requestJSON:function(t,e){return o["default"].ajax({type:"GET",url:t,dataType:"json",success:function(t,i,n){return e(t)},error:function(t){if(200===t.status)throw new Error("The JSON submitted seems not valid");console.error("Error requesting file: ",t)}}),this},loadImage:function(t,e){var i=new Image;return i.onload=function(){e&&"function"==typeof e&&e(i)},i.src=t,this},toRadians:function(t){return t*Math.PI/180}}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Interact=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),h=n(a),u=i(4);e.Interact=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];s(this,t),this.settings={container:".interact-container",timeTreshold:{tap:200,hold:500,swipe:300,flick:30},distanceTreshold:{swipe:200},overwriteViewportSettings:!1,stopPropagation:!0,preventDefault:!0,autoFireHold:!1,pinchBalanceTime:50,callbacks:{tap:null,tapHold:null,doubletap:null,hold:null,pan:null,swipe:null,flick:null,zoom:null,wheel:null,pinch:null},events:{start:{touch:this.isIE?"MSPointerDown pointerdown":"touchstart",mouse:this.isIE?"MSPointerDown pointerdown":"mousedown"},move:{touch:this.isIE?"MSPointerMove pointermove":"touchmove",mouse:this.isIE?"MSPointerMove pointermove":"mousemove"},end:{touch:this.isIE?"MSPointerUp pointerup":"touchend",mouse:this.isIE?"MSPointerUp pointerup":"mouseup"},leave:{touch:this.isIE?"MSPointerLeave pointerleave":"touchleave",mouse:this.isIE?"MSPointerLeave pointerleave":"mouseleave"},scroll:this.scrollEvent}},h["default"].extend(!0,this.settings,e||{}),this.isDown=!1,this.hasMoved=!1,this.multitouch=!1,this.lastAction=null,this.start=null,this.move=null,this.end=null,this.time=null,this.timeStart=null,this.timeEnd=null,this.timeout=null,this.holdTimeout=null,this.wasPinched=!1,this.pointerIDs={},this.settings.overwriteViewportSettings&&this.handleViewport(this.settings.overwriteViewportSettings),this.init(this.settings.container).bindEvents()}return r(t,[{key:"isMouse",get:function(){return"onmousedown"in window}},{key:"isTouch",get:function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}},{key:"isIE",get:function(){return navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}},{key:"scrollEvent",get:function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}}]),r(t,[{key:"handleViewport",value:function(t){"string"!=typeof t&&(t="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no");var e=(0,h["default"])("meta[name=viewport]").length,i=0!==e?(0,h["default"])("meta[name=viewport]"):(0,h["default"])("head").append((0,h["default"])("<meta name='viewport' />"));return i.attr("content",t),this}},{key:"init",value:function(t){if(this.$container="string"==typeof t?(0,h["default"])(t):"object"===("undefined"==typeof t?"undefined":o(t))&&t instanceof jQuery?t:(0,h["default"])(t),!(this.$container instanceof jQuery))throw new Error("Container "+t+" not found");return this.$container.css({"-ms-touch-action":"none","touch-action":"none","-ms-content-zooming":"none"}),this.container=this.$container[0],this}},{key:"bindEvents",value:function(){return this.isIE?this.bindIEEvents():(this.isTouch&&this.bindTouchEvents(),this.isMouse&&this.bindMouseEvents()),this}},{key:"bindIEEvents",value:function(){return this.$container.on(this.settings.events.scroll,this.scrollHandler.bind(this)),this.bindTouchEvents(),this.container.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this}},{key:"bindTouchEvents",value:function(){return this.$container.on(this.settings.events.start.touch,this.startHandler.bind(this)).on(this.settings.events.move.touch,this.moveHandler.bind(this)).on(this.settings.events.end.touch,this.endHandler.bind(this)).on(this.settings.events.leave.touch,this.endHandler.bind(this)),this}},{key:"bindMouseEvents",value:function(){return this.$container.on(this.settings.events.scroll,this.scrollHandler.bind(this)).on(this.settings.events.start.mouse,this.startHandler.bind(this)).on(this.settings.events.move.mouse,this.moveHandler.bind(this)).on(this.settings.events.end.mouse,this.endHandler.bind(this)).on(this.settings.events.leave.mouse,this.endHandler.bind(this)),this}},{key:"scrollHandler",value:function(t){t=t||window.event,this.settings.stopPropagation&&t.stopPropagation(),this.settings.preventDefault&&t.preventDefault();var e=this.getEvent(t)||t.originalEvent,i=this.getScrollDirection(e),n=this.getRelativePosition(e);return this.settings.callbacks.wheel&&this.eventCallback(this.settings.callbacks.wheel,{target:t.target,directions:i,position:n}),this.settings.callbacks.zoom&&(i.indexOf("up")>-1||i.indexOf("down")>-1)&&this.eventCallback(this.settings.callbacks.zoom,{target:t.target,direction:i.indexOf("up")>-1?"in":i.indexOf("down")>-1?"out":"none",position:n,factor:i.indexOf("up")>-1?1:i.indexOf("down")>-1?-1:0}),!1}},{key:"startHandler",value:function(t){if(this.settings.stopPropagation&&t.stopPropagation(),this.settings.preventDefault&&t.preventDefault(),t.button&&0!==t.button)return!1;var e=this.getEvent(t);if(this.target=t.target,this.isDown=!0,this.timeStart=t.timeStamp,this.timeout&&(this.timeout=clearTimeout(this.timeout)),e instanceof MouseEvent&&(this.start=this.getRelativePosition(e)),this.isIE&&(e instanceof MSPointerEvent||e instanceof PointerEvent))if(this.pointerIDs[e.pointerId]=e,Object.keys(this.pointerIDs).length<=1)this.start=this.getRelativePosition(e),this.multitouch=!1;else{this.multitouch=!0;var i=[];for(var n in this.pointerIDs)this.pointerIDs.hasOwnProperty(n)&&i.push(this.pointerIDs[n]);var s=this.getRelativePosition(i[0]),o=this.getRelativePosition(i[1]);this.current.distance=s.distance(o),this.start=s.add(o).divide(2,2)}else if(e.length<=1)this.start=this.getRelativePosition(e[0]);else if(2===e.length){this.multitouch=!0;var r=this.getRelativePosition(e[0]),a=this.getRelativePosition(e[1]);this.current.distance=r.distance(a),this.start=r.add(a).divide(2,2)}switch(this.lastAction){case null:this.lastAction="tap",this.settings.autoFireHold&&this.setTimeoutForEvent(this.settings.callbacks.hold,this.settings.autoFireHold,{target:this.target,positions:{start:this.start}},!0);break;case"tap":this.lastAction="doubletap",this.settings.autoFireHold&&this.setTimeoutForEvent(this.settings.callbacks.tapHold,this.settings.autoFireHold,{target:this.target,positions:{start:this.start}},!0)}return!1}},{key:"moveHandler",value:function(t){if(this.settings.stopPropagation&&t.stopPropagation(),this.settings.preventDefault&&t.preventDefault(),!this.isDown||this.wasPinched)return!1;var e=this.getEvent(t),i=void 0,n=void 0,s=this.move?this.move:this.start,o=this.time?this.time:this.timeStart,r=t.timeStamp;if(this.isIE&&(this.getRelativePosition(e).equals(s)||this.getRelativePosition(e).equals(this.start)))return!1;if(!this.isIE&&this.isTouch&&this.getRelativePosition(e[0]).equals(s))return!1;if(this.timeout&&(this.timeout=clearTimeout(this.timeout)),this.holdTimeout&&(this.holdTimeout=clearTimeout(this.holdTimeout)),this.hasMoved=!0,this.lastAction="move",this.time=t.timeStamp,e instanceof MouseEvent&&(i=this.getRelativePosition(e),n=s.distance(i)),this.isIE&&(e instanceof MSPointerEvent||e instanceof PointerEvent))if(this.pointerIDs[e.pointerId]=e,Object.keys(this.pointerIDs).length<=1)i=this.getRelativePosition(e),n=s.distance(i),this.multitouch=!1;else{this.multitouch=!0;var a=[];for(var h in this.pointerIDs)this.pointerIDs.hasOwnProperty(h)&&a.push(this.pointerIDs[h]);var u=this.getRelativePosition(a[0]),l=this.getRelativePosition(a[1]);n=u.distance(l),i=u.substract(l).divide(2,2)}else if(e.length<=1)i=this.getRelativePosition(e[0]),n=s.distance(i);else if(2===e.length){var c=this.getRelativePosition(e[0]),f=this.getRelativePosition(e[1]);n=c.distance(f),i=c.substract(f).divide(2,2)}var d=r-o;return this.multitouch?(this.current.difference=n-this.current.distance,this.current.distance=n,this.oldMove=this.move,this.move=i,this.settings.callbacks.pinch&&0!==this.current.difference&&this.eventCallback(this.settings.callbacks.pinch,{target:t.target,positions:{start:this.start,current:this.move,last:this.oldMove},distance:{current:n,differenceToLast:this.current.difference}}),this.settings.callbacks.zoom&&0!==this.current.difference&&this.eventCallback(this.settings.callbacks.zoom,{target:t.target,positions:{start:this.start,current:this.move,last:this.oldMove},direction:this.current.difference<0?"out":this.current.difference>0?"in":"none",factor:this.current.difference})):(this.speed=this.calculateSpeed(n,d),this.oldMove=this.move,this.move=i,this.eventCallback(this.settings.callbacks.pan,{target:this.target,positions:{start:this.start,current:this.move,last:s},timeElapsed:{sinceLast:d,sinceStart:r-this.timeStart},distanceToLastPoint:n,speed:this.speed})),!1}},{key:"endHandler",value:function(t){this.settings.stopPropagation&&t.stopPropagation(),this.settings.preventDefault&&t.preventDefault();var e=this.getEvent(t);this.timeEnd=t.timeStamp;var i=this.timeEnd-this.timeStart,n=this.timeEnd-this.time;if(this.holdTimeout&&(this.holdTimeout=clearTimeout(this.holdTimeout)),e instanceof MouseEvent&&(this.end=this.getRelativePosition(e)),this.isIE&&(e instanceof MSPointerEvent||e instanceof PointerEvent)?(this.end=this.getRelativePosition(e),delete this.pointerIDs[e.pointerId]):e.length<=1&&(this.end=this.getRelativePosition(e[0])),this.hasMoved||!this.isDown||this.multitouch){if(this.hasMoved&&this.isDown&&!this.multitouch){if(this.settings.callbacks.swipe||this.settings.callbacks.flick){var s=this.settings.callbacks.swipe?this.end.substract(this.start):this.end.substract(this.oldMove),o=s.length,r=s.divide(o,o),a=this.end.distance(this.start),h=this.calculateSpeed(a,i);if(this.settings.callbacks.swipe&&i<=this.settings.timeTreshold.swipe){var u=this.getAbsolutePosition(this.start),l=this.getAbsolutePosition(this.end);if(l.distance(u)>=this.settings.distanceTreshold.swipe){var c=this.getSwipeDirections(r);
this.eventCallback(this.settings.callbacks.swipe,{positions:{start:this.start,end:this.end},speed:h,directions:{named:c,detailed:r}})}}this.settings.callbacks.flick&&n<=this.settings.timeTreshold.flick&&this.eventCallback(this.settings.callbacks.flick,{speed:h,direction:r,positions:{start:this.start,end:this.end}})}switch(this.lastAction){default:this.lastAction=null}}}else switch(this.lastAction){case"tap":i<this.settings.timeTreshold.hold?this.setTimeoutForEvent(this.settings.callbacks.tap,this.settings.timeTreshold.tap,{target:this.target,positions:{start:this.start}}):this.eventCallback(this.settings.callbacks.hold,{target:this.target,positions:{start:this.start}});break;case"doubletap":i<this.settings.timeTreshold.hold?this.setTimeoutForEvent(this.settings.callbacks.doubletap,this.settings.timeTreshold.tap,{target:this.target,positions:{start:this.start,end:this.end}}):this.eventCallback(this.settings.callbacks.tapHold,{target:this.target,positions:{start:this.start,end:this.end}});break;default:this.lastAction=null}return this.multitouch&&(this.wasPinched=!0,setTimeout(function(){this.wasPinched=!1}.bind(this),this.settings.pinchBalanceTime)),this.multitouch=!1,this.isDown=!1,this.hasMoved=!1,this.isIE&&(e instanceof MSPointerEvent||e instanceof PointerEvent)?Object.keys(this.pointerIDs).length>1?this.multitouch=!0:Object.keys(this.pointerIDs).length>0&&(this.isDown=!0):(e.length>1?this.multitouch=!0:e.length>0&&(this.isDown=!0),this.move=null),!1}},{key:"calculateSpeed",value:function(t,e){return t/(e||1)*100}},{key:"getSwipeDirections",value:function(t){return[t.x<0?"left":t.x>0?"right":"none",t.y<0?"up":t.y>0?"down":"none"]}},{key:"setTimeoutForEvent",value:function(t,e,i,n){return n?this.holdTimeout=setTimeout(this.eventCallback.bind(this,t,i),e):this.timeout=setTimeout(this.eventCallback.bind(this,t,i),e),this}},{key:"eventCallback",value:function(t,e){return t&&"function"==typeof t&&t(e),this.lastAction=null,this}},{key:"getRelativePosition",value:function(t){var e=this.container.getBoundingClientRect(),i=new u.Point(t.clientX,t.clientY),n=new u.Point(e.left,e.top);return i.substract(n).divide(e.width,e.height)}},{key:"getAbsolutePosition",value:function(t){var e=this.container.getBoundingClientRect();return t.mult(e.width,e.height)}},{key:"getScrollDirection",value:function(t){var e=parseInt(t.axis,10),i=[];return t.deltaY>0||!t.deltaY&&t.wheelDeltaY<0||2===e&&t.detail>0||Math.max(-1,Math.min(1,t.wheelDelta||-t.detail))<0?i.push("down"):(t.deltaY<0||!t.deltaY&&t.wheelDeltaY>0||2===e&&t.detail<0||Math.max(-1,Math.min(1,t.wheelDelta||-t.detail))>0)&&i.push("up"),t.deltaX>0||!t.deltaX&&t.wheelDeltaX>0||1===e&&t.detail>0?i.push("right"):(t.deltaX<0||!t.deltaX&&t.wheelDeltaX<0||1===e&&t.detail<0)&&i.push("left"),i}},{key:"getEvent",value:function(t){return jQuery.event.fix(t),t.originalEvent.touches&&0===t.originalEvent.touches.length?t.originalEvent.changedTouches||t.originalEvent:t.originalEvent.touches||t.originalEvent.changedTouches||t.originalEvent}}]),t}()}])});
//# sourceMappingURL=mappedJS.min.js.map