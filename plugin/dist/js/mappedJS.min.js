!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],e):"object"==typeof exports?exports.de=e(require("jQuery")):t.de=e(t.jQuery)}(this,function(t){return function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={exports:{},id:n,loaded:!1};return t[n].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(1).MapController,o=i(2),u=i(6).Helper;e.MappedJS=function(){function t(e){var i=e.container,r=void 0===i?".mjs":i,a=e.mapData,s=void 0===a?{}:a,o=e.events,u=void 0===o?{loaded:"mjs-loaded"}:o;n(this,t),this.initializeApi(),this.initializeSettings(r,u);var c=this;return this.initializeData(s,function(){c.initializeMap(),c.bindEvents(),c.loadingFinished()}),this}return a(t,[{key:"initializeSettings",value:function(t,e){if(this.$container="string"==typeof t?o(t):"object"===("undefined"==typeof t?"undefined":r(t))&&t instanceof jQuery?t:o(t),!(this.$container instanceof jQuery))throw new Error("Container "+t+" not found");return this.$container.addClass("mappedJS"),this.events=e,this}},{key:"initializeData",value:function(t,e){var i=this;return"string"==typeof t?u.requestJSON(t,function(t){i.mapData=t,e()}):(this.mapData="object"===("undefined"==typeof t?"undefined":r(t))?t:null,e()),this}},{key:"initializeMap",value:function(){return this.$canvas=new s({container:this.$container,tilesData:this.mapData}),this}},{key:"initializeApi",value:function(){return this.api={MapController:s,Helper:u},this}},{key:"bindEvents",value:function(){return o(window).on("resize orientationchange",this.resizeHandler.bind(this)),this}},{key:"resizeHandler",value:function(){return this.$canvas.resize(),this}},{key:"loadingFinished",value:function(){return this.$container.trigger(this.events.loaded),this}}]),t}()},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(2),s=i(3).Tile,o=i(5).Publisher,u=new o;e.MapController=function(){function t(e){var i=e.container,r=e.tilesData,a=void 0===r?{}:r;if(n(this,t),!i)throw Error("You must define a container to initialize a map");return this.$container=i,this.data=a,this.initialize(),this.initializeTiles(),this}return r(t,[{key:"initialize",value:function(){return u.subscribe("tile-loaded",this.onTilesLoaded.bind(this)),this.$canvas=a("<canvas class='mjs-canvas' />"),this.canvas=this.$canvas[0],this.$container.append(this.$canvas),this.canvasContext=this.canvas.getContext("2d"),this.resize(),this}},{key:"initializeTiles",value:function(){this.tiles=[];for(var t in this.data.images){var e=this.data.images[t],i=new s(e);this.tiles.push(i)}return this}},{key:"onTilesLoaded",value:function(t){return this.drawTile(t),t.state.next(),this}},{key:"drawTile",value:function(t){return this.canvasContext.drawImage(t.img,t.x,t.y,t.width,t.height),this}},{key:"resize",value:function(){return this.canvasWidth=this.$container.innerWidth(),this.canvasHeight=this.$container.innerHeight(),this.canvasContext.canvas.width=this.canvasWidth,this.canvasContext.canvas.height=this.canvasHeight,this.draw(),this}},{key:"draw",value:function(){for(var t in this.tiles){var e=this.tiles[t];this.drawTile(e)}return this}}]),t}()},function(e,i){e.exports=t},function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=(i(2),i(4).State),s=i(5).Publisher,o=new s,u=e.Tile=function(){function t(e){var i=e.path,r=void 0===i?null:i,s=e.x,o=void 0===s?0:s,u=e.y,c=void 0===u?0:u,l=e.w,h=void 0===l?0:l,f=e.h,d=void 0===f?0:f;if(n(this,t),this.state=new a(t.STATES),!r||"string"!=typeof r||0===r.length)throw new Error("Path {path} needs to be of type string and should not be empty");return this.path=r,this.x=o,this.y=c,this.width=h,this.height=d,this.initialize(),this}return r(t,[{key:"initialize",value:function(){this.state.next();var t=this;return this.loadImage(function(e){t.img=e,t.state.next(),o.publish("tile-loaded",t)}),this}},{key:"loadImage",value:function(t){var e=new Image;return e.src=this.path,e.onload=function(){t(e)},this}}]),t}();u.STATES=[{value:0,description:"Starting"},{value:1,description:"Initialized"},{value:2,description:"Loaded"},{value:3,description:"Drawn"}]},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.State=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return i(this,t),this.STATES=e,this.i=0,this.state=this.getState(),this}return n(t,[{key:"getState",value:function(){return this.STATES[this.i]}},{key:"next",value:function(){return this.hasNext()&&this.i++,this.state=this.getState(),this}},{key:"hasNext",value:function(){return this.i<this.STATES.length}}]),t}()},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=null,a=e.Publisher=function(){function t(){return i(this,t),r||(this.subscribers={any:[]},r=this),r}return n(t,[{key:"subscribe",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"any":arguments[0],e=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];return this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push(e),this}},{key:"unsubscribe",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"any":arguments[0],i=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];return this.handle(t.UNSUBSCRIBE,e,i),this}},{key:"publish",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"any":arguments[0],i=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return this.handle(t.PUBLISH,e,i),this}},{key:"handle",value:function(e,i,n){for(var r=this.subscribers[i]?this.subscribers[i]:[],a=0;a<r.length;a++)e===t.PUBLISH?r[a](n):r[a]===n&&r.splice(a,1);return this}}]),t}();a.PUBLISH="publish",a.UNSUBSCRIBE="unsubscribe"},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2);e.Helper={requestJSON:function(t,e){n.ajax({type:"GET",url:t,dataType:"json",success:function(t,i,n){e(t)},error:function(t){if(200===t.status)throw new Error("The JSON submitted seems not valid");console.error("Error requesting file: ",t)}})}}}])});
//# sourceMappingURL=mappedJS.min.js.map