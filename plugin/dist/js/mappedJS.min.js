!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],e):"object"==typeof exports?exports.de=e(require("jQuery")):t.de=e(t.jQuery)}(this,function(t){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.MappedJS=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(1),u=i(a),h=n(2),l=n(11),c=(n(10),n(12));e.MappedJS=function(){function t(e){var n=e.container,i=void 0===n?".mjs":n,o=e.mapData,s=void 0===o?{}:o,a=e.mapSettings,u=void 0===a?{}:a,h=e.events,l=void 0===h?{loaded:"mjs-loaded"}:h;return r(this,t),this.initializeSettings(i,l,u),this.initializeData(s,function(){this.initializeMap(),this.bindEvents(),this.loadingFinished()}.bind(this)),this}return s(t,[{key:"initializeSettings",value:function(t,e,n){if(this.$container="string"==typeof t?(0,u["default"])(t):"object"===("undefined"==typeof t?"undefined":o(t))&&t instanceof jQuery?t:(0,u["default"])(t),!(this.$container instanceof jQuery))throw new Error("Container "+t+" not found");return this.$container.addClass("mappedJS"),this.mapSettings={level:n.level||0,center:n.center||{lat:0,lng:0},bounds:n.bounds||{top:90,left:-180,width:360,height:180}},this.events=e,this}},{key:"initializeData",value:function(t,e){var n=this;return"string"==typeof t?l.Helper.requestJSON(t,function(t){n.mapData=t,e()}):(this.mapData="object"===("undefined"==typeof t?"undefined":o(t))?t:null,e()),this}},{key:"initializeMap",value:function(){return this.$canvas=new h.TileMap({container:this.$container,tilesData:this.mapData,settings:this.mapSettings}),this}},{key:"bindEvents",value:function(){return this.interact=new c.Interact({}),(0,u["default"])(window).on("resize orientationchange",this.resizeHandler.bind(this)),this}},{key:"resizeHandler",value:function(){return this.$canvas.resize(),this}},{key:"loadingFinished",value:function(){return this.$container.trigger(this.events.loaded),this}}]),t}()},function(e,n){e.exports=t},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.TileMap=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(1),a=i(s),u=n(3),h=n(6),l=n(5),c=n(7),f=e.TileMap=function(){function t(e){var n=e.container,i=e.tilesData,o=void 0===i?{}:i,s=e.settings,a=void 0===s?{}:s;if(r(this,t),!n)throw Error("You must define a container to initialize a TileMap");return this.$container=n,this.imgData=o[t.IMG_DATA_NAME],this.settings=a,this.initialize(a.bounds,a.center,this.getCurrentLevelData().dimensions),this}return o(t,[{key:"left",get:function(){return this.$container.offset().left}},{key:"top",get:function(){return this.$container.offset().top}},{key:"width",get:function(){return this.$container.innerWidth()}},{key:"height",get:function(){return this.$container.innerHeight()}}]),o(t,[{key:"initialize",value:function(t,e,n){return this.view=new c.View({viewport:new l.Rectangle(this.left,this.top,this.width,this.height),mapView:new l.Rectangle(0,0,n.width,n.height),bounds:new h.Bounds(new u.LatLng(t.northWest[0],t.northWest[1]),new u.LatLng(t.southEast[0],t.southEast[1])),center:new u.LatLng(e.lat,e.lng),data:this.getCurrentLevelData(),drawCb:function(t,e,n,i,r){this.canvasContext.drawImage(t,e,n,i,r)}.bind(this)}),this.initializeCanvas(),this}},{key:"initializeCanvas",value:function(){return this.$canvas=(0,a["default"])("<canvas class='mjs-canvas' />"),this.canvas=this.$canvas[0],this.$container.append(this.$canvas),this.canvasContext=this.canvas.getContext("2d"),this.resize(),this}},{key:"getCurrentLevelData",value:function(){return this.imgData["level-"+this.settings.level]}},{key:"resize",value:function(){return this.canvasContext.canvas.width=this.width,this.canvasContext.canvas.height=this.height,this.resizeView(),this}},{key:"resizeView",value:function(){return this.view.viewport.change(this.left,this.top,this.width,this.height),this.view.drawVisibleTiles(),this}}]),t}();f.IMG_DATA_NAME="img_data"},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.LatLng=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(4);n(5),e.LatLng=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],n=arguments.length<=1||void 0===arguments[1]?0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];if(i(this,t),!r&&(e>90||-90>e||n>180||-180>n))throw new Error("latitude("+e+") is greater/smaller than +/-90 or longitude("+n+") is greater/smaller than +/-180");return this.lat=e,this.lng=n,this}return r(t,[{key:"sub",value:function(e){return new t(this.lat-e.lat,this.lng-e.lng)}},{key:"difference",value:function(e){return new t(this.lat-e.lat,this.lng-e.lng,!0)}},{key:"add",value:function(e){return new t(this.lat+e.lat,this.lng+e.lng)}},{key:"toPoint",value:function(t,e){var n=t.nw.difference(this),i=e.width/t.width,r=e.height/t.height;return new o.Point(Math.abs(n.lng*i),Math.abs(n.lat*r))}},{key:"equals",value:function(t){return this.lat===t.lat&&this.lng===t.lng}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=e.Point=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],i=arguments.length<=1||void 0===arguments[1]?0:arguments[1];return n(this,t),this.x=e,this.y=i,this}return i(t,[{key:"sub",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"add",value:function(e){return new t(this.x+e.x,this.y+e.y)}},{key:"equals",value:function(t){return this.x===t.x&&this.y===t.y}},{key:"difference",value:function(e){return new t(this.x-e.x,this.y-e.y)}},{key:"distance",value:function(t){var e=this.difference(t);return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}},{key:"translate",value:function(t,e){return this.x+=t,this.y+=e,this}}]),t}();r.createFromPoint=function(t){return new r(t.x,t.y)}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Rectangle=void 0;var s=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(4);e.Rectangle=function(t){function e(){var t,n=arguments.length<=0||void 0===arguments[0]?0:arguments[0],o=arguments.length<=1||void 0===arguments[1]?0:arguments[1],s=arguments.length<=2||void 0===arguments[2]?0:arguments[2],a=arguments.length<=3||void 0===arguments[3]?0:arguments[3];i(this,e);var u=r(this,Object.getPrototypeOf(e).call(this,n,o));return u.width=s,u.height=a,t=u,r(u,t)}return o(e,t),s(e,[{key:"center",get:function(){return new a.Point(this.x+this.width/2,this.y+this.height/2)}},{key:"topLeft",get:function(){return new a.Point(this.x,this.y)}},{key:"topRight",get:function(){return new a.Point(this.x+this.width,this.y)}},{key:"bottomLeft",get:function(){return new a.Point(this.x,this.y+this.height)}},{key:"bottomRight",get:function(){return new a.Point(this.x+this.width,this.y+this.height)}},{key:"right",get:function(){return this.x+this.width}},{key:"left",get:function(){return this.x}},{key:"top",get:function(){return this.y}},{key:"bottom",get:function(){return this.y+this.height}}]),s(e,[{key:"intersects",value:function(t){return!(t.left>this.right||t.right<this.left||t.top>this.bottom||t.bottom<this.top)}},{key:"contains",value:function(t){return t instanceof e?this.containsRect(t):t instanceof a.Point?this.containsPoint(t):!1}},{key:"containsPoint",value:function(t){return t instanceof a.Point?t.x>=this.left&&t.y>=this.top&&t.x<=this.right&&t.y<=this.bottom:!1}},{key:"containsRect",value:function(t){return t instanceof e?t.left>=this.left&&t.top>=this.top&&t.right<=this.right&&t.bottom<=this.bottom:!1}},{key:"getDistortedRect",value:function(t){return new e(this.x*t,this.y,this.width*t,this.height)}},{key:"translate",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"transform",value:function(t,e,n,i){return this.translate(t,e),this.width+=n,this.height+=i,this}},{key:"move",value:function(t,e){return this.x=t,this.y=e,this}},{key:"change",value:function(t,e,n,i){return this.move(t,e),this.width=n,this.height=i,this}},{key:"equals",value:function(t){return t instanceof e?this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height:!1}}]),e}(a.Point)},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Bounds=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(3);e.Bounds=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?new o.LatLng:arguments[0],n=arguments.length<=1||void 0===arguments[1]?new o.LatLng:arguments[1];if(i(this,t),e.lat<n.lat||e.lng>n.lng)throw new Error(e+" needs to be top-right corner and "+n+" bottom-left");return this.nw=e,this.so=n,this}return r(t,[{key:"width",get:function(){return Math.abs(this.so.lng-this.nw.lng)}},{key:"height",get:function(){return Math.abs(this.so.lat-this.nw.lat)}}]),t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=n(3),s=n(6),a=n(5),u=n(8),h=n(10),l=new h.Publisher;e.View=function(){function t(e){var n=e.viewport,r=void 0===n?new a.Rectangle:n,u=e.mapView,h=void 0===u?new a.Rectangle:u,l=e.bounds,c=void 0===l?new s.Bounds:l,f=e.center,d=void 0===f?new o.LatLng:f,v=e.data,y=void 0===v?{}:v,p=e.drawCb;return i(this,t),this.mapView=h,this.viewport=r,this.bounds=c,this.center=d,this.tiles=[],this.data=y,this.draw=p,this.bindEvents().initializeTiles(),this}return r(t,[{key:"distortion",get:function(){return Math.cos(this.center.lat)}},{key:"offset",get:function(){var t=this.center.toPoint(this.bounds,this.mapView);return this.viewport.center.sub(t)}},{key:"mapOffset",get:function(){return this.offset.x+(this.mapView.width-this.mapView.width*this.distortion)/2}},{key:"visibleTiles",get:function(){return this.tiles.filter(function(t,e,n){var i=t.getDistortedRect(this.distortion).translate(this.mapOffset,this.offset.y);return this.viewport.intersects(i)},this)}}]),r(t,[{key:"onTilesLoaded",value:function(t){return this.drawTile(t),t.state.next(),this}},{key:"drawVisibleTiles",value:function(){for(var t in this.visibleTiles)this.drawTile(this.visibleTiles[t]);return this}},{key:"drawTile",value:function(t){return t.state.current.value>=2?this.draw&&"function"==typeof this.draw?this.draw(t.img,t.x*this.distortion+this.mapOffset,t.y+this.offset.y,t.width*this.distortion,t.height):console.error("Draw method is not defined or not a function"):0===t.state.current.value&&t.initialize(),this}},{key:"bindEvents",value:function(){return l.subscribe("tile-loaded",this.onTilesLoaded.bind(this)),this}},{key:"initializeTiles",value:function(){var t=this.data.tiles;for(var e in t){var n=t[e],i=new u.Tile(n);this.tiles.push(i)}return this}}]),t}()},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.Tile=void 0;var a=function g(t,e,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,e);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:g(r,e,n)}if("value"in i)return i.value;var o=i.get;if(void 0!==o)return o.call(n)},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),h=n(1),l=(i(h),n(9)),c=n(5),f=n(10),d=n(11),v=new f.Publisher,y=[{value:0,description:"Starting"},{value:1,description:"Initialized"},{value:2,description:"Loaded"},{value:3,description:"Drawn"}],p="tile-loaded";e.Tile=function(t){function e(){var t,n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=n.path,s=n.x,a=void 0===s?0:s,u=n.y,h=void 0===u?0:u,c=n.w,f=void 0===c?0:c,d=n.h,v=void 0===d?0:d;r(this,e);var p=o(this,Object.getPrototypeOf(e).call(this,a,h,f,v));if(p.state=new l.State(y),!i||"string"!=typeof i||0===i.length)throw new TypeError("Path "+i+" needs to be of type string and should not be empty");return p.path=i,t=p,o(p,t)}return s(e,t),u(e,[{key:"Publisher",get:function(){return v}}]),u(e,[{key:"initialize",value:function(){return this.state.next(),d.Helper.loadImage(this.path,function(t){this.img=t,this.state.next(),v.publish(p,this)}.bind(this)),this}},{key:"equals",value:function(t){return t instanceof e?a(Object.getPrototypeOf(e.prototype),"equals",this).call(this,t)&&this.path===t.path:!1}}]),e}(c.Rectangle)},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=new WeakMap,o=function(t){return r.set(t,{})},s=function(t){return r.get(t)};e.State=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?[{value:0,description:"Default"}]:arguments[0];return n(this,t),o(this),s(this).STATES=e,this.i=0,this}return i(t,[{key:"next",value:function(){return this.hasNext()&&this.i++,this}},{key:"hasNext",value:function(){return this.i<s(this).STATES.length-1}},{key:"current",get:function(){return s(this).STATES[this.i]}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=null,o=e.Publisher=function(){function t(){return n(this,t),r||(this.subscribers={},r=this),r}return i(t,[{key:"subscribe",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"any":arguments[0],e=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];return this.subscribers[t]||(this.subscribers[t]=[]),this.subscribers[t].push(e),this}},{key:"unsubscribe",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"any":arguments[0],n=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1];return this.handle(t.UNSUBSCRIBE,e,n),this}},{key:"publish",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"any":arguments[0],n=arguments.length<=1||void 0===arguments[1]?[]:arguments[1];return this.handle(t.PUBLISH,e,n),this}},{key:"handle",value:function(e,n,i){for(var r=this.subscribers[n]?this.subscribers[n]:[],o=0;o<r.length;o++)e===t.PUBLISH?r[o](i):r[o]===i&&r.splice(o,1);return this}},{key:"destroy",value:function(){r=null}}]),t}();o.PUBLISH="publish",o.UNSUBSCRIBE="unsubscribe"},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.Helper=void 0;var r=n(1),o=i(r);e.Helper={requestJSON:function(t,e){return o["default"].ajax({type:"GET",url:t,dataType:"json",success:function(t,n,i){return e(t)},error:function(t){if(200===t.status)throw new Error("The JSON submitted seems not valid");console.error("Error requesting file: ",t)}}),this},loadImage:function(t,e){var n=new Image;return n.onload=function(){e&&"function"==typeof e&&e(n)},n.src=t,this}}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.Interact=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(1),a=i(s);n(10),e.Interact=function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return r(this,t),this.settings={container:".gesturizer",timing:{tap:200,hold:500,swipe:300,flick:25,pinch:50},cb:{tap:!1,tapHold:!1,doubletap:!1,hold:!1,pan:!1,swipe:!1,flick:!1,zoom:!1,wheel:!1,pinch:!1}},a["default"].extend(!0,this.settings,e||{}),this}return o(t,[{key:"isIETouch",get:function(){return navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}},{key:"isTouch",get:function(){return"ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0}},{key:"isMouse",get:function(){return"onmousedown"in window}},{key:"scrollEventName",get:function(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}}]),o(t,[{key:"getEvent",value:function(t){return a["default"].event.fix(t),t.originalEvent.touches&&0===t.originalEvent.touches.length?t.originalEvent.changedTouches||t.originalEvent:t.originalEvent.touches||t.originalEvent.changedTouches||t.originalEvent}}]),t}()}])});
//# sourceMappingURL=mappedJS.min.js.map